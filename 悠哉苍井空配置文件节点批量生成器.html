<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>VLESS æ‰¹é‡èŠ‚ç‚¹ç”Ÿæˆå™¨ï¼ˆç›´æ¥ pyipï¼‰</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
body{font-family:monospace,Arial,sans-serif;background:#f5f7fa;color:#0b2545;padding:18px;}
h1{color:#0a84ff;margin-bottom:12px;}
textarea,input{width:100%;padding:8px;margin:6px 0;border-radius:6px;border:1px solid #ccc;font-family:monospace;}
button{padding:8px 12px;border-radius:6px;border:0;background:#0a84ff;color:white;cursor:pointer;margin:4px;}
button.secondary{background:#64748b;}
button.warn{background:#ef4444;}
pre{background:#f8fafc;padding:12px;border-radius:6px;border:1px solid #e6eef2;white-space:pre-wrap;word-break:break-word;max-height:400px;overflow:auto;}
label{font-weight:bold;margin-top:8px;display:block;}
</style>
</head>
<body>

<h1>æ‚ å“‰è‹äº•ç©º-VLESSèŠ‚ç‚¹-é…ç½®æ–‡ä»¶-æ‰¹é‡ç”Ÿæˆå™¨---æ‚ å“‰TGæœ‰é—®é¢˜è”ç³»æˆ‘çš„TGï¼š@fuchenyouzaibot        ----------ï¼ˆè‹äº•ç©ºè€å¸ˆçˆ±ä½ å‘¦ï¼‰-------</h1>

<label>åœ°åŒºèŠ‚ç‚¹ä¸ºå‰ç¼€ï¼ˆç¤ºä¾‹ï¼Œç¾å›½èŠ‚ç‚¹ï¼Œé¦™æ¸¯èŠ‚ç‚¹ï¼Œå“ªä¸ªåœ°åŒºå°±å†™å“ªä¸ªåœ°åŒºåå­—ç„¶ååŠ ä¸ŠèŠ‚ç‚¹äºŒå­—ï¼Œè‡ªåŠ¨ç”ŸæˆèŠ‚ç‚¹åç§°å¹¶è‡ªåŠ¨æ’åºï¼‰</label>
<input id="regionName" placeholder="åœ°åŒºèŠ‚ç‚¹" value="åœ°åŒºèŠ‚ç‚¹">

<label>æ‰¹é‡è¾“å…¥ server å°±æ˜¯ä¼˜é€‰ipæˆ–åŸŸåï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œå”¯ä¸€ä½¿ç”¨ï¼‰</label>
<textarea id="servers" placeholder="104.17.72.164\n104.17.72.165"></textarea>

<label>æ‰¹é‡è¾“å…¥ pyip å€¼ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œå¯å¾ªç¯ä½¿ç”¨ï¼Œæ”¯æŒ IP:ç«¯å£ æˆ– åŸŸåï¼Œä¸å¸¦ http/httpsï¼‰</label>
<textarea id="pyips" placeholder="66.63.166.25:443\nyouzai.com"></textarea>

<label>è¾“å…¥ä½ çš„UUID</label>
<input id="uuid" placeholder="uuidå€¼" value="uuidç¤ºä¾‹-1111-2222-3333">

<label>è¾“å…¥ä½ çš„åŸŸåï¼ˆHostï¼‰</label>
<input id="servername" placeholder="åŸŸåå€¼" value="example.com">

<label>è¾“å…¥èŠ‚ç‚¹ç«¯å£:é»˜è®¤443å°±å¯ä»¥äº†ï¼ˆå•ç«¯å£æˆ–å¤šè¡Œå¾ªç¯ä½¿ç”¨ï¼‰</label>
<textarea id="ports" placeholder="443">443</textarea>

<div>
<button id="generateBtn">ç”Ÿæˆ æ‚ å“‰è‹äº•ç©ºé…ç½®æ–‡ä»¶YAML</button>
<button id="downloadBtn" class="secondary">ä¸‹è½½æ‚ å“‰è‹äº•ç©ºé…ç½®æ–‡ä»¶YAML</button>
<button id="copyBtn" class="secondary">å¤åˆ¶åˆ°å‰ªè´´æ¿</button>
<button id="clearBtn" class="warn">æ¸…ç©ºè¾“å…¥</button>
</div>

<label>ç”Ÿæˆé¢„è§ˆ</label>
<pre id="output"></pre>

<script>
function trimLines(s){return s? s.split(/\r?\n/).map(x=>x.trim()).filter(Boolean):[];}

function normalizePyip(raw){
  if(!raw) return '';
  raw = raw.trim();
  if(raw.toLowerCase().startsWith("/pyip=")) raw = raw.slice(6);
  raw = raw.replace(/^https?:\/\//i,'');
  return raw;
}

function makePathFromPyip(val){
  return '"/pyip=' + normalizePyip(val) + '"';
}

document.getElementById('generateBtn').addEventListener('click',()=>{
  const region = (document.getElementById('regionName').value||'').trim()||'èŠ‚ç‚¹';
  let servers = trimLines(document.getElementById('servers').value);
  let pyips = trimLines(document.getElementById('pyips').value).map(normalizePyip);
  const uuid = (document.getElementById('uuid').value||'').trim();
  const servername = (document.getElementById('servername').value||'').trim();
  let ports = trimLines(document.getElementById('ports').value);

  if(servers.length===0){alert('è¯·è‡³å°‘è¾“å…¥ä¸€ä¸ª server');return;}
  if(pyips.length===0) pyips=['127.0.0.1'];
  if(ports.length===0) ports=['443'];

  const seen=new Set(); const uniqueServers=[]; for(const s of servers){if(!seen.has(s)){seen.add(s);uniqueServers.push(s);}} servers=uniqueServers;
  servers.sort((a,b)=>{
    const da=(a.match(/\d+/g)||[]).join('')||''; const db=(b.match(/\d+/g)||[]).join('')||'';
    const na=da?parseInt(da,10):Number.MAX_SAFE_INTEGER;
    const nb=db?parseInt(db,10):Number.MAX_SAFE_INTEGER;
    if(na!==nb) return na-nb; return a.localeCompare(b);
  });

  let out=`# æ€»èŠ‚ç‚¹æ•°: ${servers.length}\n\n`;
  for(let i=0;i<servers.length;i++){
    const server=servers[i];
    const name=region+(i+1);
    const port=ports[i%ports.length]||'443';
    const pyipVal=pyips[i%pyips.length];
    const path=makePathFromPyip(pyipVal);
    out+=`- name: ${name}\n`;
    out+=`  type: vless\n`;
    out+=`  server: ${server}\n`;
    out+=`  port: ${port}\n`;
    out+=`  uuid: ${uuid}\n`;
    out+=`  tcp: true\n`;
    out+=`  udp: true\n`;
    out+=`  tls: true\n`;
    out+=`  network: ws\n`;
    out+=`  servername: ${servername}\n`;
    out+=`  ws-opts:\n`;
    out+=`    path: ${path}\n`;
    out+=`    headers:\n`;
    out+=`      Host: ${servername}\n\n`;
  }
  document.getElementById('output').textContent=out;

  // ç”ŸæˆæˆåŠŸæç¤º
  alert(`ç”Ÿæˆå®Œæˆï¼Œæ€»èŠ‚ç‚¹æ•° ${servers.length}\næ‚ å“‰ï¼Œæ­å–œä½ å³å°†å’Œè‹äº•ç©ºèµ·é£ ğŸ‰`);
});

document.getElementById('downloadBtn').addEventListener('click',()=>{
  const content=document.getElementById('output').textContent;
  if(!content){alert('è¯·å…ˆç”Ÿæˆ YAML');return;}
  const blob=new Blob([content],{type:'text/plain;charset=utf-8'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download='tg@fuchenyouzaibot.yaml';
  a.click();
  URL.revokeObjectURL(url);
});

document.getElementById('copyBtn').addEventListener('click',async()=>{
  const content=document.getElementById('output').textContent;
  if(!content){alert('è¯·å…ˆç”Ÿæˆ YAML');return;}
  try{await navigator.clipboard.writeText(content);alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');}catch(e){alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');}
});

document.getElementById('clearBtn').addEventListener('click',()=>{
  if(!confirm('æ¸…ç©ºæ‰€æœ‰è¾“å…¥å’Œè¾“å‡ºï¼Ÿ')) return;
  document.getElementById('regionName').value='åœ°åŒºèŠ‚ç‚¹';
  document.getElementById('servers').value='';
  document.getElementById('pyips').value='';
  document.getElementById('uuid').value='';
  document.getElementById('servername').value='';
  document.getElementById('ports').value='443';
  document.getElementById('output').textContent='';
});
</script>

</body>
</html>